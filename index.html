<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ã–zdenur & M.Baran NiÅŸan EtkinliÄŸi</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: url('https://i.imgur.com/your-soft-background.jpg') no-repeat center center fixed;
      background-size: cover;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    .container {
      background-color: rgba(255,255,255,0.95);
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
    }
    h2 { color: #333; margin-bottom: 10px; }
    .bot-msg { font-size: 1.1rem; margin-bottom: 20px; color: #555; }
    input[type="text"] { width: 80%; padding: 10px; margin-bottom: 15px; border-radius: 6px; border: 1px solid #ccc; font-size: 1rem; }
    input[type="file"] { margin-bottom: 20px; }
    .thumbnails { display: flex; flex-wrap: wrap; justify-content: center; margin-bottom: 20px; }
    .thumb-container { position: relative; display: inline-block; margin: 5px; }
    .thumb { width: 80px; height: 80px; object-fit: cover; border-radius: 6px; border: 1px solid #ccc; }
    .status { position: absolute; top: 2px; right: 2px; font-size: 18px; }
    button { padding: 10px 20px; font-size: 1rem; border: none; border-radius: 6px; background-color: #ff69b4; color: white; cursor: pointer; }
    button:disabled { background-color: #aaa; }
    .message { margin-top: 15px; font-size: 1rem; color: #333; }
  </style>
</head>
<body>
  <div class="container">
    <h2>EtkinliÄŸimize HoÅŸgeldiniz</h2>
    <div class="bot-msg">Etkinlikte Ã§ektiÄŸiniz fotoÄŸraflarÄ± bizimle de paylaÅŸÄ±r mÄ±snÄ±z ğŸ˜Š</div>
    <input type="text" id="username" placeholder="Ä°sminizi girin" required>
    <input type="file" id="fileInput" multiple accept="image/*">
    <div class="thumbnails" id="thumbnails"></div>
    <button id="uploadBtn">FotoÄŸraflarÄ± YÃ¼kle</button>
    <div class="message" id="message"></div>
  </div>

  <script>
    const fileInput = document.getElementById('fileInput');
    const thumbnails = document.getElementById('thumbnails');
    const uploadBtn = document.getElementById('uploadBtn');
    const message = document.getElementById('message');
    const usernameInput = document.getElementById('username');

    let selectedFiles = [];

    fileInput.addEventListener('change', (e) => {
      const files = Array.from(e.target.files);
      const seen = new Set();
      selectedFiles = [];
      thumbnails.innerHTML = '';

      files.forEach(file => {
        if(seen.has(file.name)) return;
        seen.add(file.name);
        selectedFiles.push(file);

        const reader = new FileReader();
        reader.onload = function(event) {
          const img = new Image();
          img.onload = function() {
            const canvas = document.createElement('canvas');
            const maxDim = 80;
            let w = img.width;
            let h = img.height;
            if(w > h) { h = h * (maxDim / w); w = maxDim; } 
            else { w = w * (maxDim / h); h = maxDim; }
            canvas.width = w;
            canvas.height = h;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, w, h);
            const thumbImg = document.createElement('img');
            thumbImg.src = canvas.toDataURL('image/jpeg', 0.5);
            thumbImg.className = 'thumb';

            const container = document.createElement('div');
            container.className = 'thumb-container';
            container.appendChild(thumbImg);
            const status = document.createElement('div');
            status.className = 'status';
            container.appendChild(status);

            thumbnails.appendChild(container);
            file._statusEl = status;
          }
          img.src = event.target.result;
        }
        reader.readAsDataURL(file);
      });
    });

    uploadBtn.addEventListener('click', async () => {
      const username = usernameInput.value.trim();
      if(!username) { message.textContent = 'LÃ¼tfen isminizi girin!'; return; }
      if(selectedFiles.length === 0) { message.textContent = 'LÃ¼tfen en az bir fotoÄŸraf seÃ§in!'; return; }

      uploadBtn.disabled = true;
      uploadBtn.textContent = 'YÃ¼kleniyor...';
      message.textContent = 'YÃ¼kleniyor, lÃ¼tfen bekleyin...';

      for(const file of selectedFiles){
        const formData = new FormData();
        formData.append('username', username);
        formData.append('file', file);

        try {
          const res = await fetch('https://script.google.com/macros/s/AKfycbzOKSPKrUZUJi0-_Cs1ICw94-Jrf8iDh05OLKVrsPlozZsYZ2gd-yhlpWUPQ/exec', {
            method: 'POST',
            body: formData
          });
          if(res.ok){
            file._statusEl.textContent = 'âœ…';
          } else {
            file._statusEl.textContent = 'âŒ';
          }
        } catch (err) {
          file._statusEl.textContent = 'âŒ';
          console.error(err);
        }
      }

      message.textContent = 'YÃ¼kleme tamamlandÄ±!';
      uploadBtn.disabled = false;
      uploadBtn.textContent = 'FotoÄŸraflarÄ± YÃ¼kle';
    });
  </script>
</body>
</html>